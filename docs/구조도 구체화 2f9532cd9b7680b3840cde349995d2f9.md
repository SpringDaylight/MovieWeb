# 구조도 구체화

논리 흐름 기준

```python
[외부 영화 데이터]   ──┐
                      ├─▶ A-2 영화 특성 벡터링 ──▶ [영화 벡터 DB]
[사용자 입력 데이터] ──┘                               │
                                                      │
[검색 질의 문장] ──▶ A-5 감성 검색 ────────────────────┘
                           │
[사용자 입력 텍스트] ─────▶ A-1 정서 기반 취향 모델링
                           │
                           ▼
                    A-3 취향 시뮬레이터
                           │
                           ▼
                    A-4 설명 가능한 취향 추천
                           │
                   (선택) A-6 그룹 취향 시뮬레이터
```

## 🔹 외부 영화 데이터 수집 파트

### 역할

- 영화 메타데이터 / 줄거리 / 리뷰 / 평점 수집
- **정적 데이터 파이프라인**

### 사용 AWS 서비스

| 용도 | AWS 서비스 |
| --- | --- |
| 데이터 수집 스크립트 실행 | **AWS Lambda** |
| 원본 데이터 저장 | **Amazon S3** |
| 정기 수집 트리거 | **EventBridge (Cron)** |

📌 **포인트**

- 실시간 아님 → Lambda로 충분
- S3 = 영화 데이터 레이크

## 🔹 사용자 입력 데이터

### 역할

- 실제 사용자 입력
- 프로젝트 시연 시 팀원 입력

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| API 서버 | **API Gateway** |
| 요청 처리 | **AWS Lambda** |
| 사용자 세션 | **DynamoDB** |

## 🔹 A-2. 영화 특성 벡터링

### 역할

- 영화 텍스트 → 정서·서사 요약
- 임베딩 생성
- 벡터 DB 저장

### 내부 처리

```
영화 줄거리
 → LLM 요약 (정서/서사)
 → Embedding
 → Vector DB 저장
```

### 사용 AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| LLM 호출 | **Amazon Bedrock** |
| 임베딩 생성 | **Bedrock Embedding 모델** |
| 벡터 저장 | **Amazon OpenSearch (Vector)** |
| 처리 워커 | **ECS Fargate** |

📌 **포인트**

- GPU 필요 없음
- 배치 처리 → ECS Fargate 적합

## 🔹 A-5. 자연어 기반 감성 검색

### 역할

- “느낌 검색” → 영화 후보 생성
- **A-3의 입력 생성기**

### 내부 처리

```
검색 질의
 → 임베딩
 → 벡터 DB 검색
 → 후보 영화 리스트
```

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| 질의 임베딩 | **Bedrock Embedding** |
| 벡터 검색 | **Amazon OpenSearch** |
| API | **Lambda** |

📌 **중요**

- A-5는 **A-3 앞**
- 독립 기능 ❌ → 후보 생성기 ⭕️

## 🔹 A-1. 정서 기반 취향 모델링

### 역할

- 사용자 텍스트 → 취향 벡터
- **LLM = 해석기**

### 내부 처리

```
사용자 텍스트
 →LLM 분석
 →JSON 기반 취향 벡터
```

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| LLM 분석 | **Amazon Bedrock** |
| API 처리 | **Lambda** |
| 결과 캐싱 | **DynamoDB / ElastiCache(선택)** |

📌 **포인트**

- 모델 학습 ❌
- 프롬프트 기반 구조화 ⭕️

## 🔹 A-3. 취향 시뮬레이터 (Prediction Core)

### 역할

- 사용자 × 영화
- 만족 확률 계산

### 내부 처리

```
취향 벡터 + 영화 벡터
 → 유사도 계산
 → 확률 스코어링
```

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| 계산 로직 | **Lambda** |
| 파라미터 관리 | **DynamoDB** |
| 결과 저장 | **DynamoDB** |

📌 **포인트**

- ML 모델 학습 ❌
- 결정 로직 중심

## 🔹 A-4. 설명 가능한 취향 추천

### 역할

- 숫자 → 말
- **Explainability Layer**

### 내부 처리

```
확률 + 주요 요인
 → LLM 설명 생성
```

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| 설명 생성 | **Amazon Bedrock** |
| API | **Lambda** |

## 🔹 A-6. 그룹 취향 시뮬레이터

### 역할

- 개인 취향 벡터 합성
- 그룹 만족 확률 계산

### 내부 처리

```
개인 취향 벡터 N개
 → 합성
 →A-3 재사용
```

### AWS 서비스

| 기능 | AWS 서비스 |
| --- | --- |
| 합성 로직 | **Lambda** |
| 상태 관리 | **DynamoDB** |